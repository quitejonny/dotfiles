#!/usr/bin/env bash
set -euo pipefail

ppa="ppa:hepp3n/cosmic-epoch"
package="cosmic-session"

ppa_present() {
  ls /etc/apt/sources.list.d/ 2>/dev/null | grep -q 'cosmic-epoch'
}

pkg_installed() {
  dpkg-query -W -f='${db:Status-Status}\n' "$1" 2>/dev/null | grep -qx "installed"
}

echo "Installing Cosmic desktop environment"

if ! ppa_present; then
    echo "Adding PPA: ${ppa}"
    sudo add-apt-repository -y "$ppa"
fi

if pkg_installed "$package"; then
    echo "Package already installed: ${package}"
else
    sudo apt-get update
    sudo apt-get install -y "$package"
fi
